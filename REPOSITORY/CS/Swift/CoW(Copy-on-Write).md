### 1. CoW(Copy-on-Write)
CoW가 뭘까요? Swift를 포함한 모든 프로그래밍에서 쓰이는 기술 중 하나임
컴퓨터 프로그래밍에서 복사 동작을 할 때, 실제 원본이나 복사본이 수정되기 전까지는 복사를 하지 않고 원본 리소스를 공유함. 원본이나 복사본에서 수정이 일어날 경우, 그 때 복사하는 작업을 함!

Swift 에선 Collection Type(`Array`, `Dictionary`, `Set`)과 String Type을 복사해서 사용할 때 일어난다.

예를들어, `var array1: [String] = ["명현", "동호", "소혜", "팡햄"]` 같은 배열이 있고, `var array2: [Int] = array1` 이런식으로 대입하게 되면 배열은 구조체 형식이기 때문에 값 복사가 일어난다. 이렇게 되면 `array2` 는 새로운 메모리를 할당해서 `["명현", "동호", "소혜", "팡햄"]`를 들고 있을거라 생각하는게 학계의 정설임.

하지만 CoW 를 쓰면 ?? 바로 복사하지 않음

`array2` 가 `array1`을 참조하고 있는 형태가 됨. 이러다가 원본인 `array1`이나 복사본 `array2` 둘 중 하나를 수정하게 된다면! 이 때 비로소 진짜 복사 과정이 일어나 `array2`의 값이 메모리에 할당되게 됨

![[스크린샷 2024-04-29 오후 10.48.19.png]]

이런식으로! 메모리 주소가 같은곳을 보고 있다가 새로운 값을 쓰게 되었을 때 비로소 메모리가 할당 되는 걸 볼 수 있음

### 2. 사용 용도
수정을 하지 않고 그냥 복사만 해서 가지고 있을 때, 메모리를 많이 차지하지 않고 더 효율적으로 사용할 수 있음. **실제 수정이 이뤄질 때 복사를 하고 그 전엔 참조를 통해 불필요한 복사를 줄이자!** 이게 바로 CoW의 장점이자 사용이유라 함

Swift에서는 Value Type의 복사는 깊은 복사 방식을 사용하는데 Collection Type 같은 경우는 Value Type 이지만, heap 영역에 생성되어 매번 

### 3. 작업시간은 어떨까

그렇다면 실제 복사가 일어나는 첫 수정 작업의 코드가 CoW 때문에 실행시간이 더 걸릴 것 이라는 예측으로 코드를 실행해 봤음.. 
![[스크린샷 2024-04-29 오후 11.04.52.png]]

엥 근데 왜이럼? 분명 소들좌의 블로그에선 첫번째 수정 작업 때 작업시간이 더 걸린단 말임..혹시 몰라서 작업 시간을 측정하는 다른 메서드도 사용해봤지만

![[스크린샷 2024-04-29 오후 11.10.47.png]]
어엄,,, 시도마다 다른 결과가 나옴